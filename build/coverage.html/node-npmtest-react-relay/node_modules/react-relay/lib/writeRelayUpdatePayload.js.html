<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-react-relay/node_modules/react-relay/lib/writeRelayUpdatePayload.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-react-relay">npmtest-react-relay (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-react-relay/node_modules/react-relay/lib/writeRelayUpdatePayload.js</span></h1>
    <h2>
        
        Statements: <span class="metric">12.32% <small>(26 / 211)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">2.34% <small>(3 / 128)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">3.7% <small>(1 / 27)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">11.9% <small>(25 / 210)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-react-relay/node_modules/react-relay/lib/</a> &#187; writeRelayUpdatePayload.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright (c) 2013-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * @providesModule writeRelayUpdatePayload
 * 
 */
&nbsp;
'use strict';
&nbsp;
var _extends3 = _interopRequireDefault(require('babel-runtime/helpers/extends'));
&nbsp;
var _defineProperty3 = _interopRequireDefault(require('babel-runtime/helpers/defineProperty'));
&nbsp;
var _stringify2 = _interopRequireDefault(require('babel-runtime/core-js/json/stringify'));
&nbsp;
var _keys2 = _interopRequireDefault(require('babel-runtime/core-js/object/keys'));
&nbsp;
function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : <span class="branch-1 cbranch-no" title="branch not covered" >{ 'default': obj };</span> }
&nbsp;
// TODO: Replace with enumeration for possible config types.
/* OperationConfig was originally typed such that each property had the type
 * mixed.  Mixed is safer than any, but that safety comes from Flow forcing you
 * to inspect a mixed value at runtime before using it.  However these mixeds
 * are ending up everywhere and are not being inspected */
var CLIENT_MUTATION_ID = require('./RelayConnectionInterface').CLIENT_MUTATION_ID,
    EDGES = require('./RelayConnectionInterface').EDGES;
&nbsp;
var ANY_TYPE = require('./RelayNodeInterface').ANY_TYPE,
    ID = require('./RelayNodeInterface').ID,
    NODE = require('./RelayNodeInterface').NODE;
&nbsp;
var APPEND = require('./GraphQLMutatorConstants').APPEND,
    IGNORE = require('./GraphQLMutatorConstants').IGNORE,
    PREPEND = require('./GraphQLMutatorConstants').PREPEND,
    REFETCH = require('./GraphQLMutatorConstants').REFETCH,
    REMOVE = require('./GraphQLMutatorConstants').REMOVE;
&nbsp;
var EDGES_FIELD = require('./RelayQuery').Field.build({
  fieldName: EDGES,
  type: ANY_TYPE,
  metadata: {
    canHaveSubselections: true,
    isPlural: true
  }
});
var IGNORED_KEYS = (0, _defineProperty3['default'])({
  error: true
}, CLIENT_MUTATION_ID, true);
var STUB_CURSOR_ID = 'client:cursor';
&nbsp;
/**
 * @internal
 *
 * Applies the results of an update operation (mutation/subscription) to the
 * store.
 */
<span class="fstat-no" title="function not covered" >function writeRelayUpdatePayload(writer, operation, payload, _ref) {</span>
<span class="cstat-no" title="statement not covered" >  var configs = _ref.configs,</span>
      isOptimisticUpdate = _ref.isOptimisticUpdate;
&nbsp;
<span class="cstat-no" title="statement not covered" >  configs.forEach(<span class="fstat-no" title="function not covered" >function (config) {</span></span>
<span class="cstat-no" title="statement not covered" >    switch (config.type) {</span>
      case require('./RelayMutationType').NODE_DELETE:
<span class="cstat-no" title="statement not covered" >        handleNodeDelete(writer, payload, config);</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
      case require('./RelayMutationType').RANGE_ADD:
<span class="cstat-no" title="statement not covered" >        handleRangeAdd(writer, payload, operation, config, isOptimisticUpdate);</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
      case require('./RelayMutationType').RANGE_DELETE:
<span class="cstat-no" title="statement not covered" >        handleRangeDelete(writer, payload, config);</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
      case require('./RelayMutationType').FIELDS_CHANGE:
      case require('./RelayMutationType').REQUIRED_CHILDREN:
<span class="cstat-no" title="statement not covered" >        break;</span>
      default:
<span class="cstat-no" title="statement not covered" >        console.error('Expected a valid mutation handler type, got `%s`.', config.type);</span>
    }
  });
&nbsp;
<span class="cstat-no" title="statement not covered" >  handleMerge(writer, payload, operation);</span>
}
&nbsp;
/**
 * Handles the payload for a node deletion mutation, reading the ID of the node
 * to delete from the payload based on the config and then deleting references
 * to the node.
 */
<span class="fstat-no" title="function not covered" >function handleNodeDelete(writer, payload, config) {</span>
<span class="cstat-no" title="statement not covered" >  var recordIDs = payload[config.deletedIDFieldName];</span>
<span class="cstat-no" title="statement not covered" >  if (!recordIDs) {</span>
    // for some mutations, deletions don't always occur so if there's no field
    // in the payload, carry on
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (Array.isArray(recordIDs)) {</span>
<span class="cstat-no" title="statement not covered" >    recordIDs.forEach(<span class="fstat-no" title="function not covered" >function (id) {</span></span>
      /* $FlowFixMe(&gt;=0.36.0) Flow error detected during
       * the deploy of Flow v0.36.0. To see the error, remove this comment and
       * run Flow */
<span class="cstat-no" title="statement not covered" >      deleteRecord(writer, id);</span>
    });
  } else {
    // $FlowFixMe(&gt;=0.33.0)
<span class="cstat-no" title="statement not covered" >    deleteRecord(writer, recordIDs);</span>
  }
}
&nbsp;
/**
 * Deletes the record from the store, also removing any references to the node
 * from any ranges that contain it (along with the containing edges).
 */
<span class="fstat-no" title="function not covered" >function deleteRecord(writer, recordID) {</span>
<span class="cstat-no" title="statement not covered" >  var store = writer.getRecordStore();</span>
<span class="cstat-no" title="statement not covered" >  var recordWriter = writer.getRecordWriter();</span>
  // skip if already deleted
<span class="cstat-no" title="statement not covered" >  var status = store.getRecordState(recordID);</span>
<span class="cstat-no" title="statement not covered" >  if (status === require('./RelayRecordState').NONEXISTENT) {</span>
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
&nbsp;
  // Delete the node from any ranges it may be a part of
<span class="cstat-no" title="statement not covered" >  var connectionIDs = store.getConnectionIDsForRecord(recordID);</span>
<span class="cstat-no" title="statement not covered" >  if (connectionIDs) {</span>
<span class="cstat-no" title="statement not covered" >    connectionIDs.forEach(<span class="fstat-no" title="function not covered" >function (connectionID) {</span></span>
<span class="cstat-no" title="statement not covered" >      var edgeID = require('./generateClientEdgeID')(connectionID, recordID);</span>
<span class="cstat-no" title="statement not covered" >      recordWriter.applyRangeUpdate(connectionID, edgeID, REMOVE);</span>
<span class="cstat-no" title="statement not covered" >      writer.recordUpdate(edgeID);</span>
<span class="cstat-no" title="statement not covered" >      writer.recordUpdate(connectionID);</span>
      // edges are never nodes, so this will not infinitely recurse
<span class="cstat-no" title="statement not covered" >      deleteRecord(writer, edgeID);</span>
    });
  }
&nbsp;
  // delete the node
<span class="cstat-no" title="statement not covered" >  recordWriter.deleteRecord(recordID);</span>
<span class="cstat-no" title="statement not covered" >  writer.recordUpdate(recordID);</span>
}
&nbsp;
/**
 * Handles merging the results of the mutation/subscription into the store,
 * updating each top-level field in the data according the fetched
 * fields/fragments.
 */
<span class="fstat-no" title="function not covered" >function handleMerge(writer, payload, operation) {</span>
<span class="cstat-no" title="statement not covered" >  var store = writer.getRecordStore();</span>
&nbsp;
  // because optimistic payloads may not contain all fields, we loop over
  // the data that is present and then have to recurse the query to find
  // the matching fields.
  //
  // TODO #7167718: more efficient mutation/subscription writes
<span class="cstat-no" title="statement not covered" >  for (var fieldName in payload) {</span>
<span class="cstat-no" title="statement not covered" >    if (!Object.prototype.hasOwnProperty.call(payload, fieldName)) {</span>
<span class="cstat-no" title="statement not covered" >      continue;</span>
    }
<span class="cstat-no" title="statement not covered" >    var payloadData = payload[fieldName]; </span>// #9357395
<span class="cstat-no" title="statement not covered" >    if (typeof payloadData !== 'object' || payloadData == null) {</span>
<span class="cstat-no" title="statement not covered" >      continue;</span>
    }
&nbsp;
    // check for valid data (has an ID or is an array) and write the field
<span class="cstat-no" title="statement not covered" >    if (ID in payloadData ||</span>
    // if the field is an argument-less root call, determine the corresponding
    // root record ID
    store.getDataID(fieldName) || Array.isArray(payloadData)) {
<span class="cstat-no" title="statement not covered" >      mergeField(writer, fieldName, payloadData, operation);</span>
    }
  }
}
&nbsp;
/**
 * Merges the results of a single top-level field into the store.
 */
<span class="fstat-no" title="function not covered" >function mergeField(writer, fieldName, payload, operation) {</span>
  // don't write mutation/subscription metadata fields
<span class="cstat-no" title="statement not covered" >  if (fieldName in IGNORED_KEYS) {</span>
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
<span class="cstat-no" title="statement not covered" >  if (Array.isArray(payload)) {</span>
<span class="cstat-no" title="statement not covered" >    payload.forEach(<span class="fstat-no" title="function not covered" >function (item) {</span></span>
<span class="cstat-no" title="statement not covered" >      if (typeof item === 'object' &amp;&amp; item != null &amp;&amp; !Array.isArray(item)) {</span>
<span class="cstat-no" title="statement not covered" >        if (getString(item, ID)) {</span>
<span class="cstat-no" title="statement not covered" >          mergeField(writer, fieldName, item, operation);</span>
        }
      }
    });
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
  // reassign to preserve type information in below closure
<span class="cstat-no" title="statement not covered" >  var payloadData = payload;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  var store = writer.getRecordStore();</span>
<span class="cstat-no" title="statement not covered" >  var recordID = getString(payloadData, ID);</span>
<span class="cstat-no" title="statement not covered" >  var path = void 0;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (recordID != null) {</span>
<span class="cstat-no" title="statement not covered" >    path = require('./RelayQueryPath').createForID(recordID, 'writeRelayUpdatePayload');</span>
  } else {
<span class="cstat-no" title="statement not covered" >    recordID = store.getDataID(fieldName);</span>
<span class="cstat-no" title="statement not covered" >    if (!recordID) {</span>
<span class="cstat-no" title="statement not covered" >      require('fbjs/lib/invariant')(false, 'writeRelayUpdatePayload(): Expected a record ID in the response ' + 'payload supplied to update the store for field `%s`, ' + 'payload keys [%s], operation name `%s`.', fieldName, (0, _keys2['default'])(payload).join(', '), operation.getName());</span>
    }
&nbsp;
    // Root fields that do not accept arguments
<span class="cstat-no" title="statement not covered" >    path = require('./RelayQueryPath').create(require('./RelayQuery').Root.build('writeRelayUpdatePayload', fieldName, null, null, {</span>
      identifyingArgName: null,
      identifyingArgType: null,
      isAbstract: true,
      isDeferred: false,
      isPlural: false
    }, ANY_TYPE));
  }
  // write the results for only the current field, for every instance of that
  // field in any subfield/fragment in the query.
<span class="cstat-no" title="statement not covered" >  var handleNode = <span class="fstat-no" title="function not covered" >function handleNode(node) {</span></span>
<span class="cstat-no" title="statement not covered" >    node.getChildren().forEach(<span class="fstat-no" title="function not covered" >function (child) {</span></span>
<span class="cstat-no" title="statement not covered" >      if (child instanceof require('./RelayQuery').Fragment) {</span>
<span class="cstat-no" title="statement not covered" >        handleNode(child);</span>
      } else <span class="cstat-no" title="statement not covered" >if (child instanceof require('./RelayQuery').Field &amp;&amp; child.getSerializationKey() === fieldName) {</span>
        // for flow: types are lost in closures
<span class="cstat-no" title="statement not covered" >        if (path &amp;&amp; recordID) {</span>
          // ensure the record exists and then update it
<span class="cstat-no" title="statement not covered" >          writer.createRecordIfMissing(child, recordID, path, payloadData);</span>
<span class="cstat-no" title="statement not covered" >          writer.writePayload(child, recordID, payloadData, path);</span>
        }
      }
    });
  };
<span class="cstat-no" title="statement not covered" >  handleNode(operation);</span>
}
&nbsp;
/**
 * Handles the payload for a range addition. The configuration specifies:
 * - which field in the payload contains data for the new edge
 * - the list of fetched ranges to which the edge should be added
 * - whether to append/prepend to each of those ranges
 */
<span class="fstat-no" title="function not covered" >function handleRangeAdd(writer, payload, operation, config, isOptimisticUpdate) {</span>
<span class="cstat-no" title="statement not covered" >  var clientMutationID = getString(payload, CLIENT_MUTATION_ID);</span>
<span class="cstat-no" title="statement not covered" >  require('fbjs/lib/invariant')(clientMutationID, 'writeRelayUpdatePayload(): Expected operation `%s` to have a `%s`.', operation.getName(), CLIENT_MUTATION_ID);</span>
<span class="cstat-no" title="statement not covered" >  var store = writer.getRecordStore();</span>
&nbsp;
  // Extracts the new edge from the payload
<span class="cstat-no" title="statement not covered" >  var edge = getObject(payload, config.edgeName);</span>
<span class="cstat-no" title="statement not covered" >  var edgeNode = edge &amp;&amp; getObject(edge, NODE);</span>
<span class="cstat-no" title="statement not covered" >  if (!edge || !edgeNode) {</span>
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
&nbsp;
  // Extract the id of the node with the connection that we are adding to.
<span class="cstat-no" title="statement not covered" >  var connectionParentID = config.parentID;</span>
<span class="cstat-no" title="statement not covered" >  if (!connectionParentID) {</span>
<span class="cstat-no" title="statement not covered" >    var edgeSource = getObject(edge, 'source');</span>
<span class="cstat-no" title="statement not covered" >    if (edgeSource) {</span>
<span class="cstat-no" title="statement not covered" >      connectionParentID = getString(edgeSource, ID);</span>
    }
  }
<span class="cstat-no" title="statement not covered" >  require('fbjs/lib/invariant')(connectionParentID, 'writeRelayUpdatePayload(): Cannot insert edge without a configured ' + '`parentID` or a `%s.source.id` field.', config.edgeName);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  var nodeID = getString(edgeNode, ID) || require('./generateClientID')();</span>
<span class="cstat-no" title="statement not covered" >  var cursor = edge.cursor || STUB_CURSOR_ID;</span>
<span class="cstat-no" title="statement not covered" >  var edgeData = (0, _extends3['default'])({}, edge, {</span>
    cursor: cursor,
    node: (0, _extends3['default'])({}, edgeNode, {
      id: nodeID
    })
  });
&nbsp;
  // add the node to every connection for this field
<span class="cstat-no" title="statement not covered" >  var connectionIDs = store.getConnectionIDsForField(connectionParentID, config.connectionName);</span>
<span class="cstat-no" title="statement not covered" >  if (connectionIDs) {</span>
<span class="cstat-no" title="statement not covered" >    connectionIDs.forEach(<span class="fstat-no" title="function not covered" >function (connectionID) {</span></span>
<span class="cstat-no" title="statement not covered" >      return addRangeNode(writer, operation, config, connectionID, nodeID, edgeData);</span>
    });
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (isOptimisticUpdate) {</span>
    // optimistic updates need to record the generated client ID for
    // a to-be-created node
<span class="cstat-no" title="statement not covered" >    require('./RelayMutationTracker').putClientIDForMutation(nodeID, clientMutationID);</span>
  } else {
    // non-optimistic updates check for the existence of a generated client
    // ID (from the above `if` clause) and link the client ID to the actual
    // server ID.
<span class="cstat-no" title="statement not covered" >    var clientNodeID = require('./RelayMutationTracker').getClientIDForMutation(clientMutationID);</span>
<span class="cstat-no" title="statement not covered" >    if (clientNodeID) {</span>
<span class="cstat-no" title="statement not covered" >      require('./RelayMutationTracker').updateClientServerIDMap(clientNodeID, nodeID);</span>
<span class="cstat-no" title="statement not covered" >      require('./RelayMutationTracker').deleteClientIDForMutation(clientMutationID);</span>
    }
  }
}
&nbsp;
/**
 * Writes the node data for the given field to the store and prepends/appends
 * the node to the given connection.
 */
<span class="fstat-no" title="function not covered" >function addRangeNode(writer, operation, config, connectionID, nodeID, edgeData) {</span>
<span class="cstat-no" title="statement not covered" >  var store = writer.getRecordStore();</span>
<span class="cstat-no" title="statement not covered" >  var recordWriter = writer.getRecordWriter();</span>
<span class="cstat-no" title="statement not covered" >  var filterCalls = store.getRangeFilterCalls(connectionID);</span>
<span class="cstat-no" title="statement not covered" >  var rangeBehavior = filterCalls ? require('./getRangeBehavior')(config.rangeBehaviors, filterCalls) : null;</span>
&nbsp;
  // no range behavior specified for this combination of filter calls
<span class="cstat-no" title="statement not covered" >  if (!rangeBehavior) {</span>
<span class="cstat-no" title="statement not covered" >    require('fbjs/lib/warning')(rangeBehavior, 'Using `null` as a rangeBehavior value is deprecated. Use `ignore` to avoid ' + 'refetching a range.');</span>
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (rangeBehavior === IGNORE) {</span>
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  var edgeID = require('./generateClientEdgeID')(connectionID, nodeID);</span>
<span class="cstat-no" title="statement not covered" >  var path = store.getPathToRecord(connectionID);</span>
<span class="cstat-no" title="statement not covered" >  require('fbjs/lib/invariant')(path, 'writeRelayUpdatePayload(): Expected a path for connection record, `%s`.', connectionID);</span>
<span class="cstat-no" title="statement not covered" >  path = require('./RelayQueryPath').getPath(path, EDGES_FIELD, edgeID);</span>
&nbsp;
  // create the edge record
<span class="cstat-no" title="statement not covered" >  writer.createRecordIfMissing(EDGES_FIELD, edgeID, path, edgeData);</span>
&nbsp;
  // write data for all `edges` fields
  // TODO #7167718: more efficient mutation/subscription writes
<span class="cstat-no" title="statement not covered" >  var hasEdgeField = false;</span>
<span class="cstat-no" title="statement not covered" >  var handleNode = <span class="fstat-no" title="function not covered" >function handleNode(node) {</span></span>
<span class="cstat-no" title="statement not covered" >    node.getChildren().forEach(<span class="fstat-no" title="function not covered" >function (child) {</span></span>
<span class="cstat-no" title="statement not covered" >      if (child instanceof require('./RelayQuery').Fragment) {</span>
<span class="cstat-no" title="statement not covered" >        handleNode(child);</span>
      } else <span class="cstat-no" title="statement not covered" >if (child instanceof require('./RelayQuery').Field &amp;&amp; child.getSchemaName() === config.edgeName) {</span>
<span class="cstat-no" title="statement not covered" >        hasEdgeField = true;</span>
<span class="cstat-no" title="statement not covered" >        if (path) {</span>
<span class="cstat-no" title="statement not covered" >          writer.writePayload(child, edgeID, edgeData, path);</span>
        }
      }
    });
  };
<span class="cstat-no" title="statement not covered" >  handleNode(operation);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  require('fbjs/lib/invariant')(hasEdgeField, 'writeRelayUpdatePayload(): Expected mutation query to include the ' + 'relevant edge field, `%s`.', config.edgeName);</span>
&nbsp;
  // append/prepend the item to the range.
<span class="cstat-no" title="statement not covered" >  if (rangeBehavior in require('./GraphQLMutatorConstants').RANGE_OPERATIONS) {</span>
<span class="cstat-no" title="statement not covered" >    recordWriter.applyRangeUpdate(connectionID, edgeID, rangeBehavior);</span>
<span class="cstat-no" title="statement not covered" >    writer.recordUpdate(connectionID);</span>
  } else {
<span class="cstat-no" title="statement not covered" >    console.error('writeRelayUpdatePayload(): invalid range operation `%s`, valid ' + 'options are `%s`, `%s`, `%s`, or `%s`.', rangeBehavior, APPEND, PREPEND, IGNORE, REFETCH);</span>
  }
}
&nbsp;
/**
 * Handles the payload for a range edge deletion, which removes the edge from
 * a specified range but does not delete the node for that edge. The config
 * specifies the path within the payload that contains the connection ID.
 */
<span class="fstat-no" title="function not covered" >function handleRangeDelete(writer, payload, config) {</span>
<span class="cstat-no" title="statement not covered" >  var store = writer.getRecordStore();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  var recordIDs = null;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (Array.isArray(config.deletedIDFieldName)) {</span>
<span class="cstat-no" title="statement not covered" >    recordIDs = getIDsFromPath(store, config.deletedIDFieldName, payload);</span>
  } else {
<span class="cstat-no" title="statement not covered" >    recordIDs = payload[config.deletedIDFieldName];</span>
&nbsp;
    // Coerce numbers to strings for backwards compatibility.
<span class="cstat-no" title="statement not covered" >    if (typeof recordIDs === 'number') {</span>
<span class="cstat-no" title="statement not covered" >      require('fbjs/lib/warning')(false, 'writeRelayUpdatePayload(): Expected `%s` to be a string, got the ' + 'number `%s`.', config.deletedIDFieldName, recordIDs);</span>
<span class="cstat-no" title="statement not covered" >      recordIDs = '' + recordIDs;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    require('fbjs/lib/invariant')(recordIDs == null || !Array.isArray(recordIDs) || typeof recordIDs !== 'string', 'writeRelayUpdatePayload(): Expected `%s` to be an array/string, got `%s`.', config.deletedIDFieldName, (0, _stringify2['default'])(recordIDs));</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!Array.isArray(recordIDs)) {</span>
<span class="cstat-no" title="statement not covered" >      recordIDs = [recordIDs];</span>
    }
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  require('fbjs/lib/invariant')(recordIDs != null, 'writeRelayUpdatePayload(): Missing ID(s) for deleted record at field `%s`.', config.deletedIDFieldName);</span>
&nbsp;
  // Extract the id of the node with the connection that we are deleting from.
<span class="cstat-no" title="statement not covered" >  var connectionName = config.pathToConnection.pop();</span>
<span class="cstat-no" title="statement not covered" >  var connectionParentIDs = getIDsFromPath(store, config.pathToConnection, payload);</span>
  // Restore pathToConnection to its original state
<span class="cstat-no" title="statement not covered" >  config.pathToConnection.push(connectionName);</span>
<span class="cstat-no" title="statement not covered" >  if (!connectionParentIDs) {</span>
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
<span class="cstat-no" title="statement not covered" >  var connectionParentID = connectionParentIDs[0];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  var connectionIDs = store.getConnectionIDsForField(connectionParentID, connectionName);</span>
<span class="cstat-no" title="statement not covered" >  if (connectionIDs) {</span>
<span class="cstat-no" title="statement not covered" >    connectionIDs.forEach(<span class="fstat-no" title="function not covered" >function (connectionID) {</span></span>
<span class="cstat-no" title="statement not covered" >      if (recordIDs) {</span>
<span class="cstat-no" title="statement not covered" >        recordIDs.forEach(<span class="fstat-no" title="function not covered" >function (recordID) {</span></span>
<span class="cstat-no" title="statement not covered" >          deleteRangeEdge(writer, connectionID, recordID);</span>
        });
      }
    });
  }
}
&nbsp;
/**
 * Removes an edge from a connection without modifying the node data.
 */
<span class="fstat-no" title="function not covered" >function deleteRangeEdge(writer, connectionID, nodeID) {</span>
<span class="cstat-no" title="statement not covered" >  var recordWriter = writer.getRecordWriter();</span>
<span class="cstat-no" title="statement not covered" >  var edgeID = require('./generateClientEdgeID')(connectionID, nodeID);</span>
<span class="cstat-no" title="statement not covered" >  recordWriter.applyRangeUpdate(connectionID, edgeID, REMOVE);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  deleteRecord(writer, edgeID);</span>
<span class="cstat-no" title="statement not covered" >  writer.recordUpdate(connectionID);</span>
}
&nbsp;
/**
 * Given a payload of data and a path of fields, extracts the `id` of the node(s)
 * specified by the path.
 *
 * Examples:
 * path: ['root', 'field']
 * data: {root: {field: {id: 'xyz'}}}
 *
 * path: ['root', 'field']
 * data: {root: {field: [{id: 'abc'}, {id: 'def'}]}}
 *
 * Returns:
 * ['xyz']
 *
 * ['abc', 'def']
 */
<span class="fstat-no" title="function not covered" >function getIDsFromPath(store, path, payload) {</span>
  // We have a special case for the path for root nodes without ids like
  // ['viewer']. We try to match it up with something in the root call mapping
  // first.
<span class="cstat-no" title="statement not covered" >  if (path.length === 1) {</span>
<span class="cstat-no" title="statement not covered" >    var rootCallID = store.getDataID(path[0]);</span>
<span class="cstat-no" title="statement not covered" >    if (rootCallID) {</span>
<span class="cstat-no" title="statement not covered" >      return [rootCallID];</span>
    }
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  var payloadItems = payload;</span>
<span class="cstat-no" title="statement not covered" >  path.forEach(<span class="fstat-no" title="function not covered" >function (step, idx) {</span></span>
<span class="cstat-no" title="statement not covered" >    if (!payloadItems || Array.isArray(payloadItems)) {</span>
<span class="cstat-no" title="statement not covered" >      return;</span>
    }
<span class="cstat-no" title="statement not covered" >    if (idx === path.length - 1) {</span>
<span class="cstat-no" title="statement not covered" >      payloadItems = getObjectOrArray(payloadItems, step);</span>
    } else {
<span class="cstat-no" title="statement not covered" >      payloadItems = getObject(payloadItems, step);</span>
    }
  });
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (payloadItems) {</span>
<span class="cstat-no" title="statement not covered" >    if (!Array.isArray(payloadItems)) {</span>
<span class="cstat-no" title="statement not covered" >      payloadItems = [payloadItems];</span>
    }
<span class="cstat-no" title="statement not covered" >    return payloadItems.map(<span class="fstat-no" title="function not covered" >function (item) {</span></span>
<span class="cstat-no" title="statement not covered" >      var id = getString(item, ID);</span>
<span class="cstat-no" title="statement not covered" >      require('fbjs/lib/invariant')(id != null, 'writeRelayUpdatePayload(): Expected `%s.id` to be a string.', path.join('.'));</span>
<span class="cstat-no" title="statement not covered" >      return id;</span>
    });
  }
<span class="cstat-no" title="statement not covered" >  return null;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getString(payload, field) {</span>
<span class="cstat-no" title="statement not covered" >  var value = payload[field];</span>
  // Coerce numbers to strings for backwards compatibility.
<span class="cstat-no" title="statement not covered" >  if (typeof value === 'number') {</span>
<span class="cstat-no" title="statement not covered" >    require('fbjs/lib/warning')(false, 'writeRelayUpdatePayload(): Expected `%s` to be a string, got the ' + 'number `%s`.', field, value);</span>
<span class="cstat-no" title="statement not covered" >    value = '' + value;</span>
  }
<span class="cstat-no" title="statement not covered" >  require('fbjs/lib/invariant')(value == null || typeof value === 'string', 'writeRelayUpdatePayload(): Expected `%s` to be a string, got `%s`.', field, (0, _stringify2['default'])(value));</span>
<span class="cstat-no" title="statement not covered" >  return value;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getObject(payload, field) {</span>
<span class="cstat-no" title="statement not covered" >  var value = payload[field];</span>
<span class="cstat-no" title="statement not covered" >  require('fbjs/lib/invariant')(value == null || typeof value === 'object' &amp;&amp; !Array.isArray(value), 'writeRelayUpdatePayload(): Expected `%s` to be an object, got `%s`.', field, (0, _stringify2['default'])(value));</span>
<span class="cstat-no" title="statement not covered" >  return value;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getObjectOrArray(payload, field) {</span>
<span class="cstat-no" title="statement not covered" >  var value = payload[field];</span>
<span class="cstat-no" title="statement not covered" >  require('fbjs/lib/invariant')(value == null || typeof value === 'object', 'writeRelayUpdatePayload(): Expected `%s` to be an object/array, got `%s`.', field, (0, _stringify2['default'])(value));</span>
<span class="cstat-no" title="statement not covered" >  return value;</span>
}
&nbsp;
module.exports = require('./RelayProfiler').instrument('writeRelayUpdatePayload', writeRelayUpdatePayload);
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 18 2017 12:22:36 GMT+0000 (UTC)</div>
</div>
</body>
</html>
